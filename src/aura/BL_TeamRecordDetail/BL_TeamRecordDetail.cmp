<aura:component description="BL_TeamRecordDetail" implements="forceCommunity:availableForAllPageTypes,force:hasRecordId" controller="BL_TeamRecordDetailController">
    <aura:attribute name="team" type="Object"/>
    <aura:attribute name="related" type="Object"/>
    <aura:attribute name="contactId" type="String"/>
    <aura:attribute name="showSpinnerInit" type="Boolean" default="true"/>
    <aura:attribute name="showSpinner" type="Boolean"/>
    <aura:attribute name="attachmentBody" type="String"/>
    <aura:attribute name="attachmentName" type="String"/>
    <aura:attribute name="attachmentContentType" type="String"/>
    <aura:attribute name="pictureSrc" type="String" default="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQdyq2y3f1IKjJEkyq7Dcx0oSQszq9VVm3lsiRbAR7BRCN0NCNG"/>
    <aura:attribute name="message" type="String" default="Drag team picture here"/>

    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>

    <force:recordData targetFields="{!v.team}"
                      recordId="{!v.recordId}"
                      layoutType="FULL"
                      fields="RecordType.DeveloperName, Team_Member_Count__c"
                      recordUpdated="{!c.handleRecordUpdated}"
    />

    <lightning:card title="" variant="narrow">
        <c:BL_Spinner show="{!v.showSpinnerInit}"/>
        <lightning:layout multipleRows="true" verticalAlign="center">
            <lightning:layoutItem smallDeviceSize="12" mediumDeviceSize="4" largeDeviceSize="3" size="12" >
                <c:BL_Image
                        parentId="{!v.recordId}"
                        fileName="team-logo"
                        isEditable="{!or(v.team.Player1__c == v.contactId, v.team.Player2__c == v.contactId)}"
                />
                <div style="font-size: 1.7em; font-weight: bold"><p class="slds-m-right--medium">{!v.team.Name}</p></div>
            </lightning:layoutItem>
            <lightning:layoutItem smallDeviceSize="12" mediumDeviceSize="8" largeDeviceSize="9" size="12">
                <lightning:layout multipleRows="true">
                    <lightning:layoutItem smallDeviceSize="6" mediumDeviceSize="4" largeDeviceSize="3" size="6" class="slds-p-around--medium">
                        <p class="slds-text-body_small slds-text-color_weak">{! if(v.team.RecordType.DeveloperName == 'Battle_Royale', 'Capitain', 'Player 1')}: </p>
                        <ui:outputText value="{!v.team.Player1__r.Name }" class="slds-text-heading--small"/>
                    </lightning:layoutItem>
                    <lightning:layoutItem smallDeviceSize="6" mediumDeviceSize="4" largeDeviceSize="3" size="6" class="slds-p-around--medium">
                        <aura:if isTrue="{!v.team.RecordType.DeveloperName == 'Battle_Royale'}">
                            <p class="slds-text-body_small slds-text-color_weak">Members: </p>
                            <ui:outputText value="{!v.team.Team_Member_Count__c}" class="slds-text-heading--small"/>
                            <aura:set attribute="else">
                                <p class="slds-text-body_small slds-text-color_weak">Player 2: </p>
                                <ui:outputText value="{!v.team.Player2__r.Name}" class="slds-text-heading--small"/>
                            </aura:set>
                        </aura:if>

                    </lightning:layoutItem>
                    <lightning:layoutItem smallDeviceSize="6" mediumDeviceSize="4" largeDeviceSize="3" size="6" class="slds-p-around--medium">
                        <p class="slds-text-body_small slds-text-color_weak">Wins percentage: </p>
                        <aura:if isTrue="{!greaterthan(v.team.TotalRoundsWon__c+v.team.TotalRoundsLost__c, 0)}">
                            <ui:outputNumber value="{!(v.team.Total_Games_Won__c/(v.team.Total_Games_Won__c+v.team.Total_Games_Drawn__c+v.team.Total_Games_Lost__c)) * 100}" class="slds-text-heading--small"/>%
                            <aura:set attribute="else">
                                No games played yet
                            </aura:set>
                        </aura:if>
                    </lightning:layoutItem>
                    <lightning:layoutItem smallDeviceSize="6" mediumDeviceSize="4" largeDeviceSize="3" size="6" class="slds-p-around--medium">
                        <p class="slds-text-body_small slds-text-color_weak">Goals For Average: </p>
                        <aura:if isTrue="{!greaterthan(v.team.TotalRoundsWon__c+v.team.TotalRoundsLost__c, 0)}">
                            <ui:outputNumber value="{!v.team.Total_Goals_Scored__c/(v.team.TotalRoundsWon__c+v.team.TotalRoundsLost__c)}" class="slds-text-heading--small"/>
                            <aura:set attribute="else">
                                No games played yet
                            </aura:set>
                        </aura:if>
                    </lightning:layoutItem>
                    <lightning:layoutItem smallDeviceSize="6" mediumDeviceSize="4" largeDeviceSize="3" size="6" class="slds-p-around--medium">
                        <p class="slds-text-body_small slds-text-color_weak">Goals Lost Average: </p>
                        <aura:if isTrue="{!greaterthan(v.team.TotalRoundsWon__c+v.team.TotalRoundsLost__c, 0)}">
                            <ui:outputNumber value="{!v.team.Total_Goals_Lost__c/(v.team.TotalRoundsWon__c+v.team.TotalRoundsLost__c)}" class="slds-text-heading--small"/>
                            <aura:set attribute="else">
                                No games played yet
                            </aura:set>
                        </aura:if>
                    </lightning:layoutItem>
                    <lightning:layoutItem smallDeviceSize="6" mediumDeviceSize="4" largeDeviceSize="3" size="6" class="slds-p-around--medium">
                        <p class="slds-text-body_small slds-text-color_weak">Games Won: </p>
                        <ui:outputNumber value="{!v.team.Total_Games_Won__c}" class="slds-text-heading--small"/>
                    </lightning:layoutItem>
                    <lightning:layoutItem smallDeviceSize="6" mediumDeviceSize="4" largeDeviceSize="3" size="6" class="slds-p-around--medium">
                        <p class="slds-text-body_small slds-text-color_weak">Games Lost: </p>
                        <ui:outputNumber value="{!v.team.Total_Games_Lost__c}" class="slds-text-heading--small"/>
                    </lightning:layoutItem>
                    <lightning:layoutItem smallDeviceSize="6" mediumDeviceSize="4" largeDeviceSize="3" size="6" class="slds-p-around--medium">
                        <p class="slds-text-body_small slds-text-color_weak">Games Drawn: </p>
                        <ui:outputNumber value="{!v.team.Total_Games_Drawn__c}" class="slds-text-heading--small"/>
                    </lightning:layoutItem>
                </lightning:layout>
            </lightning:layoutItem>
        </lightning:layout>
    </lightning:card>
</aura:component>